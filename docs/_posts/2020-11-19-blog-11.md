---
layout: post
title:  "Terraform Build and Config"
date:   2020-11-19 20:24:26 -0700
categories: Terraform Configuration
---

<h1><b>Intro</b></h1>
How to begin building Terraform infrastructure. For this start-up we have to create infrastructure on AWS, as it is common and widely known. Terraform can handle several providers in one configuration, including many providers in one single config. We do this in a free AWS account, however, it can only use services that are eligible under free AWS tier for getting started guide. It could be paid to certain amount of money to have extra features.

The file collection used to define the terraform infrastructure is known as a terraform configuration. Next, we write the first configuration to start one instance of AWS EC2. A layout must be in a directory of its own.For the new setup, we create a new directory.

{% highlight ruby %}
$ mkdir terraform-aws-instance
{% endhighlight %}

Then change into the new directory. 

{% highlight ruby %}
$ cd terraform-aws-instance
{% endhighlight %}

Now we create a new file for the config code.

{% highlight ruby %}
$ touch file.tf
{% endhighlight %}

Copy paste the following setup into file.tf and save. When the terraform run all files in the working directory ending in tf will be loaded.

{% highlight ruby %}
provider "aws" {
  profile = "default"
  region  = "us-west-1"
}

resource "aws_instance" "file" {
  ami           = "ami-830c94e3"
  instance_type = "t2.micro"
}
{% endhighlight %}

The first command to execute in a new layout.

{% highlight ruby %}
$ terraform init
{% endhighlight %}

In the same directory as the generated file, run terraform apply.

{% highlight ruby %}
$ terraform apply
{% endhighlight %}

We can expect comparable performance like that. To build actual infrastructure to fit the setup, this output displays the implementation plan detailing which steps it will take. The format of the output is similar to the various formats created by tools such as git. The production has a plus that will be generated next to the resource. It displays the attributes that will be set below.

If successfully developed the plan, terraform will now pause and wait for approval before prociding. If something looks wrong or unsafe with the scheme, it is safe to abort here with no modifications made to the infrastructure. It will take a few minutes for the plan to be executed while terraform waits for the ec2 example to be available. Terraform is all over after that.

You should go to the AWS console to see the instance of ec2 generated. Terraform wrote some details into the terraform.tfstate file as well. This file is really critical. It tracks the generated resourced ID so that terraform understands what it manages. It has to use the terraform display to inspect the current condition.

{% highlight ruby %}
$ terraform show
{% endhighlight %}

When it is finished, we run terraform destroy to remove all the resources generated by this setup. 

{% highlight ruby %}
$ terraform destroy
{% endhighlight %}